DROP TABLE RESERVAS;


CREATE TABLE RESERVAS(
    PROTOCOLO INT,
    MATRICULA NUMBER(9),
    IDENTIFICADOR NUMBER(9),
    DATA_INICIO DATE,
    DATA_TERMINO DATE,
    PRIMARY KEY (PROTOCOLO),
    CONSTRAINT FK_MATRICULA FOREIGN KEY (MATRICULA) REFERENCES FUNCIONARIO (MATRICULA),
    CONSTRAINT FK_IDENTIFICADOR FOREIGN KEY (IDENTIFICADOR) REFERENCES EQUIPAMENTO (IDENTIFICADOR)
);

insert into RESERVAS (PROTOCOLO,MATRICULA,IDENTIFICADOR,DATA_INICIO,DATA_TERMINO) 
select 885533, 123456389, 333 , TO_DATE('2019/05/03 21:02:44', 'yyyy/mm/dd hh24:mi:ss'), TO_DATE('2019/05/03 21:02:44', 'yyyy/mm/dd hh24:mi:ss') from dual
union all select 9933333, 123456389, 444 , TO_DATE('2019/05/03 21:02:44', 'yyyy/mm/dd hh24:mi:ss'), TO_DATE('2019/05/03 21:02:44', 'yyyy/mm/dd hh24:mi:ss') from dual
union all select 66`3333, 123456389, 333 , TO_DATE('2019/05/03 21:02:44', 'yyyy/mm/dd hh24:mi:ss'), TO_DATE('2019/05/03 21:02:44', 'yyyy/mm/dd hh24:mi:ss') from dual;



SELECT * FROM RESERVAS;
SELECT * FROM RESERVAS INNER JOIN FUNCIONARIO ON RESERVAS.MATRICULA = FUNCIONARIO.MATRICULA Where DATA_INICIO >= sysdate -1;


SELECT FUNCIONARIO.NOME, COUNT(*) 
FROM RESERVAS INNER JOIN FUNCIONARIO ON RESERVAS.MATRICULA = FUNCIONARIO.MATRICULA  
WHERE IDENTIFICADOR = 333 group by FUNCIONARIO.NOME ;
